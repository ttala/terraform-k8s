data "scaleway_instance_snapshot" "snapshot" {
  name = "image-scw-master-node-snap0"
}

resource "scaleway_instance_volume" "from_snapshot" {
  from_snapshot_id = data.scaleway_instance_snapshot.snapshot.id
  type = "b_ssd"
}
image-scw-master-node
0851b492-f690-45d5-a2c2-48efdf631bff

resource "scaleway_instance_ip" "public_ip" {
  zone = "fr-par-1"
}

resource scaleway_vpc_private_network pnet {
    name = "pvn-kube-nc"
}

resource "scaleway_instance_server" "scw-master-node" {
  type = "PLAY2-NANO"
  ip_id = scaleway_instance_ip.public_ip.id
  image = "image-scw-master-node"
  zone = "fr-par-1"
  private_network {
    pn_id = scaleway_vpc_private_network.pnet.id
  }
}

  connection {
    type        = "ssh"
    user        = "root" # or "ubuntu", depending on your image
    private_key = file("~/.ssh/id_rsa")
    host        = scaleway_instance_ip.public_ip.address
  }

  provisioner "file" {
    source      = "k8s_install.sh"
    destination = "/tmp/k8s_install.sh"
  }

  provisioner "remote-exec" {
    inline = [
      "chmod +x /tmp/k8s_install.sh",
      "/tmp/k8s_install.sh"
    ]
  }